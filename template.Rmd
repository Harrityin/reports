---
title: "大脑学习能力测评"
subtitle: "集体报告"
date: "2017年12月8日"
output:
  word_document:
    toc: true
    fig_caption: true
    reference_docx: docs/word-styles-reference-report.docx
toc-title: "目录"
params:
  user_info:
    label: "学生基本信息:"
    value: data/user_info_test.rds
    input: file
  user_exam:
    label: "学生考试得分:"
    value: data/user_exam_test.rds
    input: file
  user_ability:
    label: "学生能力得分:"
    value: data/user_ability_test.rds
    input: file
  time_tf:
    label: "是否自动获得学生测评时间？"
    value: true
    input: checkbox
  time:
    label: "学生测评时间（取消勾选上一项后请认真填写）:"
    value: !r date()
    input: date
  abilities:
    label: "请选择所有需要报告的能力:"
    value: ["反应力", "注意力", "记忆力", "自控力", "思维力"]
    input: select
    choices: ["反应力", "注意力", "记忆力", "自控力", "思维力"]
    multiple: true
---

```{r load packages and configurations, include=FALSE}
# load packages
library(tidyverse)
library(extrafont)
# parse params
user_info_file <- params$user_info
user_exam_file <- params$user_exam
user_ability_file <- params$user_ability
assess_time_auto <- params$time_tf
assess_time <- params$time
abilities <- params$abilities
# ability descriptions
abdesc <- setNames(
  c(
    "注意是大脑接收和处理个体外部和内部信息的前提，只有被注意到的信息才能得到有效的分析和处理，并用来解决问题并形成持久的记忆。",
    "记忆力是人脑智力的集中体现，也是人脑比电脑更聪明的重要原因。个体的生存和发展需要不断掌握新的知识，记忆能将这些知识经验存储下来并合理运用。记忆连接着人的过去和未来，丰富着我们的精神生活并塑造着我们的性格。",
    "反应力是对各种信息、要求和指令等做出快速反应的能力。速度是衡量反应力最重要的指标,它体现了大脑各个系统的协调、整合发展的水平，与整个神经网络的效率有密切关系。",
    "自控力是人们能够根据目标和环境的要求，控制和改变自己的思想和行为，克服冲动，并抵制诱惑，让自己的行为符合社会期许和长期目标。自控力主要体现为控制冲动的能力，抵制诱惑的能力以及信息更新的能力。",
    "思维力指人脑对客观事物的概括反映能力。良好的思维力让我们能快速的掌握概念，进行推理，并更好的认识事物及事物间的关系。人的思维力在一生中不断发展，在顺应其客观发展规律的基础上重视对思维力的培养，对于学习和生活都尤为重要。"
  ),
  c("注意力", "记忆力", "反应力", "自控力", "思维力")
)
# configuration settings
meta_vars <- c("userId", "姓名", "性别", "学校", "年级", "班")
rnk_cutedges_ability <- qnorm(c(0, 0.3, 0.7, 0.9, 1)) * 15 + 100
# let knitr kable output NA as empty string
options(knitr.kable.NA = "")
# get the last modification time of data files
mtimes <- lapply(
  Sys.glob(c(user_info_file, user_exam_file, user_ability_file)),
  function(x) file.info(x)$mtime
)
```

```{r load data, include=FALSE, cache=TRUE, cache.extra=mtimes}
# load user information
user_info <- read_rds(user_info_file)
# load user exam information
user_exam <- read_rds(user_exam_file)
# load user ability score
user_ability <- read_rds(user_ability_file)
# if not input assess time, use the median of createTime/createDate
if (assess_time_auto){
  # get the real time variable
  time_var_cand <- c("createTime", "createDate")
  time_var <- time_var_cand[time_var_cand %in% names(user_ability)]
  assess_time <- median(user_ability[[time_var]])
}
# do some transformations
schools <- unique(user_info$学校)
```

# 报告说明

---

“大脑学习能力”测评系统（以下简称学习能力测评）由北京师范大学脑与学习科学研究中心与成都爱智游科技有限公司联合编制。“大脑学习能力”测评系统整合了国际国内脑科学研究最新成果，依据脑功能分化和整合原理，以及大脑功能可塑性原理，采用计算机化认知测试的方式，全面测查与个体学习和发展密切相关的“大脑学习能力”。同传统智力测验相比，“大脑学习能力”测评具有科学性强、实施方便、准确度高、预测效度好、可反复测试等优势，代表了当今脑力测试的新趋势。

“大脑学习能力”测评综合考察注意力、记忆力、反应力、自控力等与人脑信息加工、学习、适应和发展密切相关的重要高级功能和大脑学习能力。这些能力覆盖了大脑的核心功能网络，是人脑智慧的集中体现。大量证据表明，个体在这些能力中的表现与其智力，学习能力，社会适应能力和未来发展潜力具有密切关系。

“大脑学习能力”测评提供多种能力维度指标，包含综合的大脑学习能力指数（Brain Learning Ablility Index, BLAI）和各个能力维度指数（注意力指数、记忆力指数、反应力指数、自控力指数）。

# 学生参加测评的情况

---

**测评时间**：`r strftime(assess_time, "%Y年%b") # format as "yyyy年MM月"`

**实测人数[^1]**：`r length(unique(user_ability$userId))`人

```{r count users, echo=FALSE, message=FALSE, warning=FALSE}
user_info %>%
  group_by(学校, 年级) %>%
  summarise(人数 = length(unique(userId))) %>%
  knitr::kable(caption = "各学校各年级实测人数")
```

[^1]: 即实际测得数据中，至少包含所测能力中的一项的学生总数，可能会少于计划参加测评的学生总数。

# 详细报告

---

## 大脑学习能力指数

```{r calculate BLAI, echo=FALSE, message=FALSE, warning=FALSE}
BLAI <- user_ability %>%
  group_by(userId) %>%
  summarise(BLAI = mean(abscore, na.rm = TRUE)) %>%
  mutate(rank = cut(BLAI, rnk_cutedges_ability, LETTERS[4:1])) %>%
  inner_join(user_info)
```

综合能力分数由大脑学习能力指数（BLAI）表示，它反映了注意力、记忆力、自控力、反应力这四方面认知能力的综合水平。

```{r summary statistics for BLAI by grade, echo=FALSE, message=FALSE, warning=FALSE}
BLAI %>%
  group_by(学校, 年级) %>%
  summarise(
    人数 = n(),
    平均分 = mean(BLAI),
    标准差 = sd(BLAI),
    最高分 = max(BLAI),
    最低分 = min(BLAI),
    A = sum(rank == "A"),
    B = sum(rank == "B"),
    C = sum(rank == "C"),
    D = sum(rank == "D")
  ) %>%
  knitr::kable(digits = 2, caption = "BLAI指数简表[^2]")
```

[^2]: A，B，C，D四个等级分别表示优秀（全国同龄水平90%以上），良好（全国同龄水平70%-90%），普通（全国同龄水平30%-70%），不足（全国同年龄水平30%以下）。表中列出了处于各个等级的学生人数。

```{r summary statistics for BLAI by class, echo=FALSE, message=FALSE, warning=FALSE}
BLAI %>%
  group_by(学校, 年级, 班) %>%
  summarise(
    人数 = n(),
    平均分 = mean(BLAI),
    标准差 = sd(BLAI),
    最高分 = max(BLAI),
    最低分 = min(BLAI),
    A = sum(rank == "A"),
    B = sum(rank == "B"),
    C = sum(rank == "C"),
    D = sum(rank == "D")
  ) %>%
  knitr::kable(digits = 2, caption = "各年级各班BLAI指数简表")
```

### 各年级学业成绩与BLAI指数的相关关系

```{r lesson and BLAI, echo=FALSE, message=FALSE, warning=FALSE, fig.cap=fig_captions}
fig_captions <- paste0(schools, "学生学业成绩和BLAI指数的相关关系")
BLAI_exam <- user_exam %>%
  inner_join(BLAI)
for (school in schools){
  schoolplot <- BLAI_exam %>%
    filter(学校 == school) %>%
    ggplot(aes(BLAI, 成绩, color = 学科)) +
    geom_point() +
    stat_smooth(method = "glm") +
    facet_wrap(~年级, scales = "free") +
    theme_minimal() +
    labs(
      title = paste0("BLAI与学业成绩的关系"),
      x = "BLAI指数",
      y = "学业成绩"
    ) +
    theme(
      title = element_text(family = "SimHei"),
      plot.title = element_text(hjust = 0.5)
    )
  # render the plot
  print(schoolplot)
  # in order that the captions would render
  cat("\n\n")
}
```

```{r ability content, echo=FALSE, warning=FALSE, message=FALSE, results='asis', fig.cap=fig_captions}
count_ab2rep <- length(abilities)
count_school <- length(schools)
fig_captions <- paste0(
  rep(schools, times = count_ab2rep),
  "学生学业成绩和",
  rep(abilities, each = count_school),
  "指数的相关关系"
)
for (ability_name in abilities){
  # data extract
  ability_data <- user_ability %>%
    filter(abname == ability_name) %>%
    mutate(rank = cut(abscore, rnk_cutedges_ability, LETTERS[4:1])) %>%
    inner_join(user_info)
  ability_exam <- user_exam %>%
    inner_join(ability_data)
  if (nrow(ability_exam) == 0)
    next
  # header message
  cat(paste0("## ", ability_name, "指数\n\n", abdesc[ability_name], "\n\n"))
  # score statistics by grade
  ability_data %>%
    group_by(学校, 年级) %>%
    summarise(
      人数 = n(),
      平均分 = mean(abscore),
      标准差 = sd(abscore),
      最高分 = max(abscore),
      最低分 = min(abscore),
      A = sum(rank == "A"),
      B = sum(rank == "B"),
      C = sum(rank == "C"),
      D = sum(rank == "D")
    ) %>%
    knitr::kable(digits = 2,
                 caption = paste0(ability_name, "得分简表")) %>%
    print()
  # score statistics by class
  ability_data %>%
    group_by(学校, 年级, 班) %>%
    summarise(
      人数 = n(),
      平均分 = mean(abscore),
      标准差 = sd(abscore),
      最高分 = max(abscore),
      最低分 = min(abscore),
      A = sum(rank == "A"),
      B = sum(rank == "B"),
      C = sum(rank == "C"),
      D = sum(rank == "D")
    ) %>%
    knitr::kable(digits = 2,
                 caption = paste0("各年级各班", ability_name, "得分简表")) %>%
    print()
  # figure header
  cat(paste0("\n\n### 各年级学业成绩与", ability_name, "的相关关系\n\n"))
  for (school in schools){
    schoolplot <- ability_exam %>%
      filter(学校 == school) %>%
      ggplot(aes(abscore, 成绩, color = 学科)) +
      geom_point() +
      stat_smooth(method = "glm") +
      facet_wrap(~年级, scales = "free") +
      theme_minimal() +
      labs(
        title = paste0(ability_name, "与学业成绩的关系"),
        x = paste0(ability_name, "得分"),
        y = "学业成绩"
      ) +
      theme(
        title = element_text(family = "SimHei"),
        plot.title = element_text(hjust = 0.5)
      )
    # render the plot
    print(schoolplot)
    # in order that the captions would render
    cat("\n\n")
  }
}
```

# 发展建议

---

为了促进孩子大脑学习能力的全面发展，提高大脑学习能力整体水平，我们提供以下建议，以供参考 :

1. **父母要以身作则**

---

父母是孩子最重要的学习榜样，所以首先要以身作则，给孩子树立一个良好的榜样，做事情的时候要专注、仔细、耐心，控制自己的脾气，灵活处理突发事件。这样，小孩在无意识的模仿学习的过程中也能慢慢的形成这些品质。

2. **鼓励和表扬**

---

当孩子全神贯注做某件事情时，建议家长要不失时机的给予鼓励和肯定。因为鼓励和表扬是对小孩行为表现的肯定，会促使小孩下次再表现出这些行为。例如，在小孩完成作业之后，对小孩说“刚刚你写作业的时候表现很认真，看到你一心一意的完成作业，妈妈感觉很佩服你！”

3. **尊重发展规律**

---

了解孩子的认知发展特点，尊重和理解孩子，不苛求孩子。例如：一般7—10岁儿童注意力能持续20分钟左右，思维力比较单一；青春期的小孩比较容易冲动等等。因此，当小孩的表现没有达到预期时，家长不要急于责骂，建议结合认知能力发展规律寻找原因。

4. **培养设立目标的好习惯**

---

只有当孩子明白自己想要做什么、应该做什么的时候，才能规范自己的行为朝着目标前进，可以鼓励孩子认真设立目标；将目标分享给同学、老师、家长，让他们监督自己；将目标写下来贴在家里，时刻提醒等。

5. **认知能力训练**

---

使用针对性的认知能力训练。认知能力训练主要是依据儿童认知能力发展规律，结合个体的认知能力发展特点，制定科学性的认知能力训练任务和训练日程，针对性地提高儿童认知能力水平。例如，为了加强思维力，可以让孩子每天坚持完成一些思维力训练的任务，并及时给出反馈。
