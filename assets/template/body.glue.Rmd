```{r <<ability_name>>-configs, include=FALSE}
ability_name_cn <- ability_names["<<ability_name>>"]
scores_this_ability <- scores_combined %>%
  filter(ability == ability_name_cn)
bp_stats <- boxplot.stats(scores_this_ability$score)
```

```{r <<ability_name>>-description, results="asis", echo=FALSE}
ability_info %>%
  filter(name == ability_name_cn) %>%
  # see 'build.R' at root directory for how `md` (Markdown) is generated
  pull(md) %>%
  cat()
cat("\n\n")
```

```{r <<ability_name>>-histogram, echo=FALSE, warning=FALSE, message=FALSE, fig.cap="本区和本校学生分数分布对比"}
scores_this_ability %>%
  filter(region != "各班") %>%
  ggplot(aes(score, fill = region)) +
  geom_density(color = NA, alpha = 0.5) +
  scale_y_continuous(breaks = NULL, expand = c(0, 0)) +
  scale_fill_brewer(palette = "Paired") +
  labs(x = "分数", y = "", fill = "") +
  set_theme_dist(base_family = text_family)
```

全校学生总体的基础能力测评的得分分布见图\@ref(fig:<<ability_name>>-histogram)，从图中可以看出，本校学生得分主要集中在【】区间中，整体表现较【】。与全区分布相比，在【】区组学生比例更大。

```{r <<ability_name>>-boxplot, echo=FALSE, warning=FALSE, message=FALSE, fig.cap="本区、本校和本校各班学生分数情况对比"}
ggplot(scores_this_ability, aes(cls, score, fill = cls)) +
  geom_boxplot(outlier.color = NA, width = 0.5) +
  facet_wrap(~ region, scales = "free_y", ncol = 1) +
  scale_y_continuous(limits = bp_stats$stats[c(1, 5)]) +
  scale_fill_brewer(palette = "Pastel1", guide = FALSE) +
  labs(x = "", y = "分数", fill = "") +
  coord_flip() +
  set_theme_panels(base_family = text_family)
```

```{r <<ability_name>>-tab, echo=FALSE, warning=FALSE, message=FALSE}
ability_summary <- scores_this_ability %>%
  sum_tab()
ability_summary %>%
  rename(` ` = cls) %>%
  select(-region) %>%
  knitr::kable(digits = 2, caption = "本区、本校和本校各班学生分数情况表")
```

从表\@ref(tab:<<ability_name>>-tab)中我们可以看出，【】班学生的表现最好，而【】【】班学生总体表现低于全校平均水平，在后期应该重点关注这【】个班级的基础能力发展情况，对于表现低于平均水平的学校应该定期实施干预。

从表\@ref(tab:<<ability_name>>-tab)中可以看到，每个班级的学生从等级优秀到不足的占比情况存在差异，应该重点关注在等级D中占比较大的班级，对学生的基础能力进行有计划的训练和干预。

```{r <<ability_name>>-grading, echo=FALSE, warning=FALSE, message=FALSE, fig.cap="本区、本校和本校各班各水平人数比例"}
ability_summary %>%
  gather(level, n, A:D) %>%
  mutate(
    prop = n / 实测人数 * 100,
    prop_label = if_else(round(prop) == 0, NA_real_, round(prop))
  ) %>%
  ggplot(aes(cls, prop, fill = level, label = prop_label)) +
  geom_col(position = "stack", width = 0.5) +
  geom_text(position = position_stack(vjust = 0.5), size = 3) +
  facet_wrap(~ region, scales = "free_y", ncol = 1) +
  scale_fill_brewer(palette = "Blues") +
  labs(x = "", y = "比例（%）", fill = "") +
  coord_flip() +
  set_theme_panels(base_family = text_family)
```

本校学生总体在基础能力测评中各个水平的人数比例如图\@ref(fig:<<ability_name>>-grading)，其中，各水平的含义如下: A 水平:优秀；B水平：良好；C 水平:达到课程标准的基本要求；D 水平:未达到课程标准水平。
